
\documentclass[journal]{IEEEtran}

% *** CITATION PACKAGES ***
%
\usepackage{cite}

% *** GRAPHICS RELATED PACKAGES ***
%
\ifCLASSINFOpdf
   \usepackage[pdftex]{graphicx}
  % declare the path(s) where your graphic files are
  % \graphicspath{{../pdf/}{../jpeg/}}
  % and their extensions so you won't have to specify these with
  % every instance of \includegraphics
 \DeclareGraphicsExtensions{.pdf,.jpeg,.png}
\else
  % or other class option (dvipsone, dvipdf, if not using dvips). graphicx
  % will default to the driver specified in the system graphics.cfg if no
  % driver is specified.
  \usepackage[dvips]{graphicx}
  % declare the path(s) where your graphic files are
  \graphicspath{{./figs/}}
  % and their extensions so you won't have to specify these with
  % every instance of \includegraphics
  \DeclareGraphicsExtensions{.eps}
\fi

% *** MATH PACKAGES ***
%
\usepackage{amsmath}


% *** SPECIALIZED LIST PACKAGES ***
%
%\usepackage{algorithmic}
% algorithmic.sty was written by Peter Williams and Rogerio Brito.
% This package provides an algorithmic environment fo describing algorithms.
% You can use the algorithmic environment in-text or within a figure
% environment to provide for a floating algorithm. Do NOT use the algorithm
% floating environment provided by algorithm.sty (by the same authors) or
% algorithm2e.sty (by Christophe Fiorio) as the IEEE does not use dedicated
% algorithm float types and packages that provide these will not provide
% correct IEEE style captions. The latest version and documentation of
% algorithmic.sty can be obtained at:
% http://www.ctan.org/pkg/algorithms
% Also of interest may be the (relatively newer and more customizable)
% algorithmicx.sty package by Szasz Janos:
% http://www.ctan.org/pkg/algorithmicx




% *** ALIGNMENT PACKAGES ***
%
%\usepackage{array}
% Frank Mittelbach's and David Carlisle's array.sty patches and improves
% the standard LaTeX2e array and tabular environments to provide better
% appearance and additional user controls. As the default LaTeX2e table
% generation code is lacking to the point of almost being broken with
% respect to the quality of the end results, all users are strongly
% advised to use an enhanced (at the very least that provided by array.sty)
% set of table tools. array.sty is already installed on most systems. The
% latest version and documentation can be obtained at:
% http://www.ctan.org/pkg/array


% IEEEtran contains the IEEEeqnarray family of commands that can be used to
% generate multiline equations as well as matrices, tables, etc., of high
% quality.




% *** SUBFIGURE PACKAGES ***
%\ifCLASSOPTIONcompsoc
%  \usepackage[caption=false,font=normalsize,labelfont=sf,textfont=sf]{subfig}
%\else
\usepackage[caption=false,font=footnotesize]{subfig}
%\fi
% subfig.sty, written by Steven Douglas Cochran, is the modern replacement
% for subfigure.sty, the latter of which is no longer maintained and is
% incompatible with some LaTeX packages including fixltx2e. However,
% subfig.sty requires and automatically loads Axel Sommerfeldt's caption.sty
% which will override IEEEtran.cls' handling of captions and this will result
% in non-IEEE style figure/table captions. To prevent this problem, be sure
% and invoke subfig.sty's "caption=false" package option (available since
% subfig.sty version 1.3, 2005/06/28) as this is will preserve IEEEtran.cls
% handling of captions.
% Note that the Computer Society format requires a larger sans serif font
% than the serif footnote size font used in traditional IEEE formatting
% and thus the need to invoke different subfig.sty package options depending
% on whether compsoc mode has been enabled.
%
% The latest version and documentation of subfig.sty can be obtained at:
% http://www.ctan.org/pkg/subfig




% *** FLOAT PACKAGES ***
%
%\usepackage{fixltx2e}
% fixltx2e, the successor to the earlier fix2col.sty, was written by
% Frank Mittelbach and David Carlisle. This package corrects a few problems
% in the LaTeX2e kernel, the most notable of which is that in current
% LaTeX2e releases, the ordering of single and double column floats is not
% guaranteed to be preserved. Thus, an unpatched LaTeX2e can allow a
% single column figure to be placed prior to an earlier double column
% figure.
% Be aware that LaTeX2e kernels dated 2015 and later have fixltx2e.sty's
% corrections already built into the system in which case a warning will
% be issued if an attempt is made to load fixltx2e.sty as it is no longer
% needed.
% The latest version and documentation can be found at:
% http://www.ctan.org/pkg/fixltx2e


%\usepackage{stfloats}
% stfloats.sty was written by Sigitas Tolusis. This package gives LaTeX2e
% the ability to do double column floats at the bottom of the page as well
% as the top. (e.g., "\begin{figure*}[!b]" is not normally possible in
% LaTeX2e). It also provides a command:
%\fnbelowfloat
% to enable the placement of footnotes below bottom floats (the standard
% LaTeX2e kernel puts them above bottom floats). This is an invasive package
% which rewrites many portions of the LaTeX2e float routines. It may not work
% with other packages that modify the LaTeX2e float routines. The latest
% version and documentation can be obtained at:
% http://www.ctan.org/pkg/stfloats
% Do not use the stfloats baselinefloat ability as the IEEE does not allow
% \baselineskip to stretch. Authors submitting work to the IEEE should note
% that the IEEE rarely uses double column equations and that authors should try
% to avoid such use. Do not be tempted to use the cuted.sty or midfloat.sty
% packages (also by Sigitas Tolusis) as the IEEE does not format its papers in
% such ways.
% Do not attempt to use stfloats with fixltx2e as they are incompatible.
% Instead, use Morten Hogholm'a dblfloatfix which combines the features
% of both fixltx2e and stfloats:
%
% \usepackage{dblfloatfix}
% The latest version can be found at:
% http://www.ctan.org/pkg/dblfloatfix




%\ifCLASSOPTIONcaptionsoff
%  \usepackage[nomarkers]{endfloat}
% \let\MYoriglatexcaption\caption
% \renewcommand{\caption}[2][\relax]{\MYoriglatexcaption[#2]{#2}}
%\fi
% endfloat.sty was written by James Darrell McCauley, Jeff Goldberg and 
% Axel Sommerfeldt. This package may be useful when used in conjunction with 
% IEEEtran.cls'  captionsoff option. Some IEEE journals/societies require that
% submissions have lists of figures/tables at the end of the paper and that
% figures/tables without any captions are placed on a page by themselves at
% the end of the document. If needed, the draftcls IEEEtran class option or
% \CLASSINPUTbaselinestretch interface can be used to increase the line
% spacing as well. Be sure and use the nomarkers option of endfloat to
% prevent endfloat from "marking" where the figures would have been placed
% in the text. The two hack lines of code above are a slight modification of
% that suggested by in the endfloat docs (section 8.4.1) to ensure that
% the full captions always appear in the list of figures/tables - even if
% the user used the short optional argument of \caption[]{}.
% IEEE papers do not typically make use of \caption[]'s optional argument,
% so this should not be an issue. A similar trick can be used to disable
% captions of packages such as subfig.sty that lack options to turn off
% the subcaptions:
% For subfig.sty:
% \let\MYorigsubfloat\subfloat
% \renewcommand{\subfloat}[2][\relax]{\MYorigsubfloat[]{#2}}
% However, the above trick will not work if both optional arguments of
% the \subfloat command are used. Furthermore, there needs to be a
% description of each subfigure *somewhere* and endfloat does not add
% subfigure captions to its list of figures. Thus, the best approach is to
% avoid the use of subfigure captions (many IEEE journals avoid them anyway)
% and instead reference/explain all the subfigures within the main caption.
% The latest version of endfloat.sty and its documentation can obtained at:
% http://www.ctan.org/pkg/endfloat
%
% The IEEEtran \ifCLASSOPTIONcaptionsoff conditional can also be used
% later in the document, say, to conditionally put the References on a 
% page by themselves.




% *** PDF, URL AND HYPERLINK PACKAGES ***
%
%\usepackage{url}
% url.sty was written by Donald Arseneau. It provides better support for
% handling and breaking URLs. url.sty is already installed on most LaTeX
% systems. The latest version and documentation can be obtained at:
% http://www.ctan.org/pkg/url
% Basically, \url{my_url_here}.




% *** Do not adjust lengths that control margins, column widths, etc. ***
% *** Do not use packages that alter fonts (such as pslatex).         ***
% There should be no need to do such things with IEEEtran.cls V1.6 and later.
% (Unless specifically asked to do so by the journal or conference you plan
% to submit to, of course. )

% correct bad hyphenation here
\hyphenation{op-tical net-works semi-conduc-tor}

\begin{document}
%
\title{Bicycle Wheel System Identification and Optimal Truing Control for Mechatronic Systems}
%
%
% author names and IEEE memberships
% note positions of commas and nonbreaking spaces ( ~ ) LaTeX will not break
% a structure at a ~ so this keeps an author's name from being broken across
% two lines.
% use \thanks{} to gain access to the first footnote area
% a separate \thanks must be used for each paragraph as LaTeX2e's \thanks
% was not built to handle multiple paragraphs
%

\author{Aaron~Hunter% <-this % stops a space
\thanks{A. Hunter is a PhD student at the Department of Computer Science and Engineering, University of California, Santa Cruz, CA, 95060 USA e-mail: aamuhunt@ucsc.edu.}% <-this % stops a space
\thanks{Manuscript received month day, year; revised month day, year.}}

% note the % following the last \IEEEmembership and also \thanks - 
% these prevent an unwanted space from occurring between the last author name
% and the end of the author line. i.e., if you had this:
% 
% \author{....lastname \thanks{...} \thanks{...} }
%^------------^------------^----Do not want these spaces!
%
% a space would be appended to the last name and could cause every name on that
% line to be shifted left slightly. This is one of those "LaTeX things". For
% instance, "\textbf{A} \textbf{B}" will typeset as "A B" not "AB". To get
% "AB" then you have to do: "\textbf{A}\textbf{B}"
% \thanks is no different in this regard, so shield the last } of each \thanks
% that ends a line with a % and do not let a space in before the next \thanks.
% Spaces after \IEEEmembership other than the last one are OK (and needed) as
% you are supposed to have spaces between the names. For what it is worth,
% this is a minor point as most people would not even notice if the said evil
% space somehow managed to creep in.



% The paper headers
\markboth{IEEE/ASME Transactions on Mechatronics,~Vol.~yy, No.~x, Month~Year}%
{Hunter \MakeLowercase{\textit{et al.}}: Bare Demo of IEEEtran.cls for IEEE Journals}
% The only time the second header will appear is for the odd numbered pages
% after the title page when using the twoside option.
% 
% *** Note that you probably will NOT want to include the author's ***
% *** name in the headers of peer review papers.                   ***
% You can use \ifCLASSOPTIONpeerreview for conditional compilation here if
% you desire.




% If you want to put a publisher's ID mark on the page you can do it like
% this:
%\IEEEpubid{0000--0000/00\$00.00~\copyright~2015 IEEE}
% Remember, if you use this you must call \IEEEpubidadjcol in the second
% column for its text to clear the IEEEpubid mark.



% use for special paper notices
%\IEEEspecialpapernotice{(Invited Paper)}

% make the title area
\maketitle

% As a general rule, do not put math, special symbols or citations
% in the abstract or keywords.
\begin{abstract}
This paper describes an \emph{in-situ} empirical modeling technique of a conventional bicycle wheel that is employed to determine the optimal tension adjustments necessary to align the wheel in lateral and radial directions while maintaining uniform tension of the spokes. The technique allows the mean tension of the spokes to be adjusted independently from variations around the mean. Additionally, a control algorithm is developed that uses lateral feedback and predicted intermediate wheel states to bring the wheel into alignment to any desired tension in a single iteration of adjustments of the tension of the spokes.  Experimental validation of the algorithm is demonstrated on a poorly tensioned and misaligned wheel. The wheel is taken from an initial state ($\mathbf{\mu \pm \sigma}$): tension $\mathbf{=556 \pm 211}$N, lateral $\mathbf{=0.160 \pm 0.736}$mm, radial $\mathbf{=0.05 \pm 0.158}$mm to a final state: lateral $\mathbf{=-0.037\pm 0.107}$mm, radial $\mathbf{=-0.046\pm0.047}$mm, tension $\mathbf{=1009\pm45}$N in a single iteration of the truing algorithm.
\end{abstract}

% Note that keywords are not normally used for peerreview papers.
\begin{IEEEkeywords}
IEEE, IEEEtran, journal.
\end{IEEEkeywords}

% For peer review papers, you can put extra information on the cover
% page as needed:
% \ifCLASSOPTIONpeerreview
% \begin{center} \bfseries EDICS Category: 3-BBND \end{center}
% \fi
%
% For peerreview papers, this IEEEtran command inserts a page break and
% creates the second title. It will be ignored for other modes.
\IEEEpeerreviewmaketitle



\section{Introduction}
% The very first letter is a 2 line initial drop letter followed
% by the rest of the first word in caps.
\IEEEPARstart{T}{he} spoked bicycle wheel is one of the most ubiquitous tensioned structures in the world. While much has been written about modeling the structure itself (see \cite{FordThesis} for a comprehensive literature review) very little has been published regarding the assembly and tuning of the structure itself.  This work presents a framework for a rigorous approach to empirically modeling a bicycle wheel and provides for an optimal tensioning method for all wheels of the same type.  This framework is intended for integration into a mechatronic wheel manufacturing apparatus although the results presented here were produced by hand, albeit with the assistance of measurement sensors and a computer. 

The approach presented in this paper builds upon the one patented by Papadapolous \cite{Papadapoulos} and alluded to in \cite{HollandMech} for the wheel tensioning method. This approach is to determine the influence of a tension adjustment of each spoke on the lateral, radial and spoke tension parameters of a specific wheel.  These influence functions are placed into a model in matrix form.  This model is then employed to compute a weighted least squares estimation of the tension adjustments that minimize the wheel parameter variations for a given wheel under tensioning.  Where this work improves upon previous approaches is to provide tension targeting and a method for feedback control during the tensioning process to minimize cumulative adjustment errors. 

\section{Background}
The bicycle wheel structure consists of a rim, spokes, spoke nipples, and a hub as shown in Fig(\ref{geom}).  The hub anchors the spoke which is connected to the rim by a nippled threaded onto its end.  The nipple is seated in the rim. The wheel stiffness is generated by providing tension to the spokes by tightening the nipples until the desired tension is achieved. Lateral stiffness of the wheel is provided by the lateral component of the spoke tension due to the spoke angles $\alpha_{nd}$ and $\alpha_d$. Lateral stiffness prevents rim warping out of the wheel plane and allows for adjustment of lateral variations. Radial stiffness and compensation is provided by the radial component of the spoke tension. The optimal tension of the wheel is a balance between the two--high enough tension to support the anticipated load, but below the value that begins to induce rim warpage \cite{FordThesis}. Note that there are two other degrees of freedom for rim displacements:  tangential (rim compression) and torsion around the rim shear center.  The former acts to change the circumference of the rim and is a much smaller effect than the lateral or radial dimensions.  The latter might be of concern for wheels containing spokes significantly offset from the rim center. Both of these effects should be addressed in rim design. 

Spoking patterns vary from purely radial to nearly tangential relative to the hub and determined by angle $\beta$.  Tangential spoke patterns allow for torque transmission from the hub to the rim, as occurs through the drive train or from disc brakes, so most wheels have some tangential component, the exception being front wheels with rim brakes.

The process of adjusting the tension to minimize the lateral and radial variations of the wheel is called truing. The typical procedure for wheel truing by hand is a heuristic where first some average spoke tension is applied by tightening all the spoke nipples, then the lateral variations are iteratively reduced, and finally the radial variations are minimized. The wheel tension is then increased incrementally and the procedure is repeated until the wheel parameter specifications are met \cite{Brandt}.

The wheel can be modeled as a system of springs operating in a linear regime \cite{FordThesis}. Because of this linear property, the wheel parameter variations induced by a set of spokes can be decomposed into superposed individual spoke tensions, lending itself to influence matrix approach developed in the next section.

\begin{figure}[!t]
\centering
    \subfloat[]{
        \includegraphics[width=0.09\textwidth]{rim_x}
    }
    \subfloat[]{
        \includegraphics[width=0.375\textwidth]{geom}
    }
    \caption{Wheel geometry. (a)  Rim cross section.  The lateral direction is defined to point toward the non-drive side of the wheel.  The radial direction points outwards from the hub.  The spoke angles $\alpha_{{nd}}$ and $\alpha_{{d}}$ provide lateral stiffness to the wheel. (b) Side view of a wheel. The rim angle, $\theta$, is referenced to the valve stem.  The angle, $\beta$, results from the wheel spoke pattern,  A purely radially spoked wheel has $\beta = 0$.}
    \label{geom}
    \end{figure}

\section{Apparatus}
To develop the model a symmetric (i.e., tensioned equally on both sides), front wheel was built by hand using a Stans ZTR Alpha rim, a White Industries MI5 hub, and 32 DT Swiss Competition spokes.  A so-called `three-cross' tangential spoke pattern was employed for the wheel geometry.  All adjustments were performed on a Centrimaster Comfort wheel truing stand (Fig \ref{fig:apparatus}).  This stand has radial and lateral mechanical dial gauges to measure the rim displacements with 0.1 mm gauge markings. To obtain optimal resolution and minimize data collection time, a Canon EOS M digital camera with a 22mm focal length lens was used to capture images from the dial gauges.  A computer vision algorithm was used to analyze the images and calculate the displacements.  The spoke tension measurements were taken with a  WheelFanatyk digital tension gauge. This instrument measures displacement of the spoke under a known spring tension. This displacement is converted to a measured tension based on a lookup table provided by the manufacturer. It has an accuracy of 10 \% and the measurements are discretized to 0.01 mm.

\begin{figure}[!t]
\centering
\includegraphics[width=2.5in,angle=-90]{./imgs/apparat.jpg}
\caption{Apparatus used to measure lateral and radial displacements.}
\label{fig:apparatus}
\end{figure}

\section{Method}

\subsection{Wheel Model}
The approach taken here is to determine the effect of a unit change in spoke tension on the lateral, radial and tension parameters of a wheel as a function of rim angle.  The resulting curves are referred to as the influence functions of the spoke. To find these influence functions a series of experiments are performed on a subset of the spokes in a given wheel.  For each experiment a spoke is loosened by one complete rotation and measurements are taken at equal increments along the rim, for the radial and lateral displacements, and the tension of every spoke is measured. The data are used to develop the influence functions, The influence functions for each spoke are then placed into matrix forms such that each column represents the influence of a given spoke and each row represents a discrete rim angle.  In other words, if $u_s (\theta), v_s(\theta), \text{ and }t_s(\theta)$ are the lateral and radial influence functions for spoke $s \in [1,2, \cdots , n_s]$, then the influence matrices $\Phi_u, \Phi_v \text{ and } \Phi_t$  for the lateral, radial and tension parameters respectively, at the discrete rim angles $\theta \in [\theta_1,\theta_2,\cdots, \theta_n]$ are given by:

\begin{align*}
    \bf u_s &=  \begin{bmatrix}
        u_s(\theta_1)\\
        u_s(\theta_2)\\
        \vdots\\
        u_s(\theta_n)
        \end{bmatrix}
    \bf v_s = \begin{bmatrix}
        v_s(\theta_1)\\
        v_s(\theta_2)\\
        \vdots\\
        v_s(\theta_n)
    \end{bmatrix}
        \bf t_s = \begin{bmatrix}
        t_s(\theta_1)\\
        t_s(\theta_2)\\
        \vdots\\
        t_s(\theta_n)
    \end{bmatrix}
    \end{align*}
    \begin{align*}
     \Phi_u &= \begin{bmatrix}
     \bf u_1 & \bf u_2& \dots & \bf u_{n_s}
     \end{bmatrix}\\
     \Phi_v &= \begin{bmatrix}
     \bf v_1 & \bf v_2& \dots & \bf v_{n_s}
     \end{bmatrix}\\     
     \Phi_t &= \begin{bmatrix}
     \bf t_1 & \bf t_2& \dots & \bf t_{n_s}
     \end{bmatrix} 
\end{align*}
The influence matrices are the models of the wheel for each parameter.  We combine these matrices into a single matrix $\Phi$:
 \begin{align}
 \Phi = 
     \begin{bmatrix}
         \Phi_u\\
         \Phi_v\\
         \Phi_t
     \end{bmatrix}
     \label{eq:phi}
 \end{align}
Given a vector of tension adjustments (i.e., rotations of the spoke nipples), $\mathbf d$, the prediction of the wheel state after applying the adjustments is given by:
\begin{align}
\mathbf{\hat Y} &= 
     \mathbf{Y_b} + \Phi  \mathbf{d} 
     \label{eq:Y_hat}
 \end{align}
where $\mathbf{\hat Y}$ is the predicted state of the wheel after tensioning and $\mathbf{Y_b}$ is the state of the wheel prior to tensioning. 

To find the optimal vector of spoke tension adjustments $\mathbf{d}_{ls}$ that result in a measured state relative to a perfect wheel at average tention $\bar T$ we solve the weighted least squares approximation using a set of measurements $ [ {\bf u,v,T}-\bar T ]$, and the weights $\mu_v \text{ and }\mu_t$:
\begin{align*}
    \tilde \Phi &= \begin{bmatrix}
    \Phi_u\\
    \Phi_v \sqrt {\mu_v}\\
    \Phi_t \sqrt {\mu_t}
    \end{bmatrix} \quad
    \bf \tilde Y = \begin{bmatrix}
    \mathbf {u} - u_0 \\
   (\mathbf {v}- v_0)  \sqrt {\mu_v}\\
    ( {\bf  T} - \bar T )  \sqrt {\mu_t}
    \end{bmatrix} 
\end{align*}
\begin{align}
        {\bf d}_{ls} &= \tilde \Phi^\dagger {\bf \tilde Y}
        \label{eq:dls}
\end{align}
Where $\tilde \Phi^\dagger$ is the pseudo-inverse of $\tilde \Phi$.  Typically $u_0$ and $v_0$ are zero reflecting the fact that the gauge has been set to zero at the desired lateral and radial locations during setup. The weighting factors represent the tradeoff between the lateral, radial, and tension variables and account for the difference in units, the quality of measurements, as well as the specification for each parameter. The weighting factors are determined through simulation and validated experimentally. Once ${\bf d}_{ls}$ is found the wheel is trued to its optimal state, ${\bf \hat Y}_{ls}$ by applying $\mathbf{d}_{adj} = -{\bf d}_{ls}$ to the wheel:
\begin{align}
\mathbf{\hat Y}_{ls} &= \mathbf{Y_b} + \Phi  \mathbf{d} _{adj}
\label{eq:Yls}
\end{align}

\subsection{Tension Targeting}
In theory adjusting a wheel to any arbitrary average tension is accomplished by setting $\bar T = T_d$, where $T_d$ is the desired tension.  In practice however, the tension influence functions are noisy and lack the necessary precision to target tension accurately.  However, the wheel symmetry can be exploited to make the following observation.  If every spoke of a symmetric wheel is tightened by the same amount then the radial and lateral displacements are unaffected and only the mean tension is changed. It is possible therefore to decouple the average tension change from spoke tension non-uniformity. It should be apparent that this is possible for asymmetric wheels as well, such as a drive wheel or wheel with a disc brake, by compensating for the different spoke angles. 

The approach is as follows.  First calculate ${\bf d}_{ls}$ as in (\ref{eq:dls}) and subtract its mean value:
\begin{align*}
    \mathbf{d} &= -(\mathbf{d}_{ls} - \bar d_{ls})\\
\end{align*}
If the adjustments, $\bf d$, are applied to the spokes, the lateral, radial and tension variations will be minimized as before, but without affecting the average tension.  Then calculate the necessary constant shift $d_{cm}$ to bring the average tension to $T_d$:
\begin{align*}
    d_{cm} &=  (T_d - \bar T)/c
\end{align*}
Where the proportionality constant, $c$, is determined experimentally. The spoke vector that will optimally true the wheel becomes:
\begin{align}
    \mathbf{d}_{adj} =\mathbf{d}  + d_{cm} 
\end{align}

\subsection{Optical Digitization}
The method for converting the analog dial gauge readings into digital measurements merits some discussion.  Although a mechatronic implementation of a wheel tensioning machine would likely use digital gauges, it is instructive to demonstrate the effectiveness of optical digitization.  Prior to taking measurements two  images are collected.  The first is a reference image taken with the gauge needles outside the range of expected data range.  The second image is taken with the needles set to zero.  With these two images any subsequent image of a measurement is processed in the following manner.  The measurement image is subtracted from the reference image after appropriate smoothing.  If the images are taken under the same conditions, what remains after subtraction is a ghost image of the needles themselves. A binary threshold is applied to the subtracted image and masked.  Finally, the centroid of the needle tip is determined and an angle from the gauge center to the tip is calculated and compared to the measurement at zero.  The angle is then converted into displacement using the gauge resolution. This process is shown in Fig(\ref{fig:cv_img}).  


\begin{figure}[!t]
    \centering
    \subfloat[]{
        \includegraphics[width=0.2\textwidth]{./imgs/zero}
    }
    \quad
    \subfloat[]{
        \includegraphics[width=0.2\textwidth]{./imgs/threshold_img}
    }
    \caption{Images used to measure analog dial gauges with computer vision. Image (a) is the measurement image.  Image (b) is generated by subtracting the measurement image from a reference image and applying binary threshold and masking operations (concentric circles). The angle of the needles is measured relative to the gauge center and the converted to a displacement measurement.}
    \label{fig:cv_img}
\end{figure}


\subsection{Wheel Truing Algorithm}
Having determined the optimal spoke adjustments, ${\bf d}_{adj}$, the remaining task is to apply them to the wheel. Although this sounds deceptively simple, there are some difficulties doing this accurately.  The main one is a problem of spoke twist. Spokes are not torsionally stiff and will twist significantly during nipple rotation.  Thus it is difficult to precisely determine how far the spoke nipple has been adjusted based entirely on the rotation angle of the spoke nipple. The servo accuracy or precision may also be inadequate, leading to the accumulation of errors over multiple spoke adjustments. This is particularly true at higher spoke tensions where the friction of the nipple-spoke interface can lead to discrete jumps in nipple rotation. Finally, even if the nipple has been adjusted properly but the spoke is twisted, over time it can un-twist which may result in tension loss of the spoke and cause the wheel to go out of true. 

Although the use of high precision servos and clamping the spoke during adjustment improve the wheel truing process, this paper demonstrates a method that minimizes these sources of variability using lateral feedback during each spoke adjustment. The method begins with the first element of ${\bf d}_{adj}$. Using (\ref{eq:Y_hat}) the post-adjustment lateral displacement at the rim angle of that spoke is predicted for a target displacement.  The spoke tension is then adjusted until the lateral measurement equals the target displacement. Spoke twist is then eliminated by measuring the spoke rotation hysteresis and setting the spoke nipple angle midway in the hysteresis regime. Note that this lateral target is not zero, but rather the intermediate state of the wheel after the adjustment of the first spoke.  Then a prediction is made of the lateral state at the rim angle of the second spoke after the first \emph{two} adjustments have been performed.  The second spoke tension is adjusted until the target is reached in the same manner of the first. This process continues sequentially for every element in ${\bf d}_{adj}$. This method minimizes any accumulation of adjustment error while eliminating spoke twist.  Fig(\ref{fig:algo}) shows the intermediate lateral states of a wheel undergoing this method along with the lateral targets for each spoke adjustment. 

\begin{figure}[!t]
\centering
\includegraphics[width=3.5 in]{./figs/algo}
\caption{Example of the truing algorithm. The dashed line is the baseline lateral state.  The thin lines are the predicted states after each spoke adjustment. The spoke tension is adjusted until the lateral measurement equals the diamond target and proceeds from the first spoke (leftmost) to the last.  The thick line is the predicted final state with its truing target. }
\label{fig:algo}
\end{figure}

\section{Results}
\subsection{Optical Digitization of Lateral and Radial Measurements}
To provide for higher precision measurements and to automate analog to digital conversion of the analog dial gauge measurements a computer vision algorithm was employed.  To validate the measurement reliability a series of four images were taken.  They were first analyzed for their readings manually (through pixel level measurement of the angle of the needles) and then compared against the results returned by the algorithm.  Both dial gauges were set to approximately the following settings:  1.0 mm, 0.5 mm, 0.25 mm, and 0.0 mm.  Fig(\ref{fig:cv}) shows the comparison between the two methods.  The estimated effective displacement resolution of the manual measurement method is approximately 0.014 mm.  The computer vision algorithm returned values within $\pm$0.007 mm of the manual measurements. 
\begin{figure}[!t]
\centering
\includegraphics[width=3.25 in]{./figs/CV}
\caption{Validation of the computer vision algorithm developed to interpret analog dial gauge measurements.  Both the lateral and radial dials were set to approximately 1, 0.5, 0.25, and 0.0mm.  The measurements were interpreted through visual estimation of the images as well as by the algorithm. The results agree to better than the estimate of the resolution of the manual technique.}
\label{fig:cv}
\end{figure}

\subsection{Influence Curves}
The influence curves for the lateral and radial displacements were taken at 64 equally spaced locations on the rim--at each spoke and halfway between each spoke.  32 curves were measured, one for each spoke in the wheel.  These curves were averaged and in the case of the radial displacement, the mean value subtracted (for our purposes the rim is considered incompressible in the tangential direction, thus a tension change should not induce an average radial change).  The subsequent influence curves are shown in Fig(\ref{fig:gclr}).  The tension influence curves were measured for each spoke.  This particular spoking geometry results in four distinct tension curves, depending on whether the spoke is on the drive side of the wheel, or the non-drive side, and whether it is a `leading' spoke or a `trailing' spoke, that is whether its spoke angle, $\beta$, is positive or negative (see Fig()).  Because this is a symmetric wheel, however, the non-drive side leading spoke influence curve is a mirror image of the drive side trailing one.  Similarly, the non-drive side trailing spoke influence curve is a mirror image of the drive side leading one. This symmetry was exploited to generate the four tension influence curves in Fig(\ref{fig:gc_ten}), such that each curve represents the average of 16 curves and is mirrored when necessary.

The lateral and radial influence curves can be used directly and put into the influence matrices.  Alternatively, they can be fit to the Fourier series. The Fourier series is an ideal modeling method for these curves due to their continuous nature and $2\pi$ periodicity. The tension measurements are inherently discrete, however, so modeling them in this manner, while feasible, is not useful as the model requires as many terms as there are measurement for fidelity. There are analytical models available (see \cite{ModeMatrix} for an open source example), however, they require extensive characterization of the rim that is not possible \emph{in-situ}.  Therefore, for this work only the smoothed data were used for the influence matrices.  

\begin{figure}[!t]
\centering
\includegraphics[width=3.25 in]{./figs/gc_lat_rad}
\caption{The mean influence curves for the lateral and radial parameters.  These curves are the average of 32 measured curves.}
\label{fig:gclr}
\end{figure}

\begin{figure}[!t]
\centering
\includegraphics[width=3.25 in]{./figs/gc_ten}
\caption{The mean influence curves for spoke tension. From top to bottom: (a) Non-drive side leading. (b) Drive-side leading. (c) Non-drive side trailing. (d) Drive side trailing.  Note that (a) and (d) are mirror images, as are (b) and (c).}
\label{fig:gc_ten}
\end{figure}

\subsection{Simulation}
With the influence matrices developed as in (\ref{eq:phi}) the state of the wheel can be predicted for a given set of spoke tension adjustments.  To find acceptable values for the weighting factors, $\mu_v,\mu_t$, a series of simulations were performed.  For each simulation a random vector of spoke adjustments was generated and a wheel state prediction was calculated using (\ref{eq:Y_hat}). To this wheel state white noise was added to simulate the uncertainty of the measurement.  The noise distributions were determined from the measured profiles generated during the influence curve development.  The initial weighting factors were developed based on a comparison of the magnitude of the changes induced by a unit disturbance of the three parameters, normalized to the maximum lateral displacement. The weighted least squares estimation of the random spoke vector was then computed using these weighting factors and (\ref{eq:dls}). and the predicted final state of the wheel is calculated using (\ref{eq:Yls}). The weighting factors were then modified until both the predicted performance of the algorithm met a specification of $\pm$ 0.1mm in lateral and radial error and $\pm$50 N in tension error relative to a perfectly true wheel. The predicted spoke vector is generally found to agree to an rms of $\leq$ 0.1 revolutions. Fig(\ref{fig:simd}) shows the result of one such simulation. After extensive simulation acceptable weighting factors were found to be: $\mu_v = 0.5$, $ \mu_t =10^{-5}$.

\begin{figure}[!t]
\centering
\includegraphics[width=3.25 in]{./figs/simd}
\caption{The actual and predicted spoke tensioning values used during a simulation of wheel truing.  The prediction agrees with the actual values to an rms error of 0.05 revolutions.}
\label{fig:simd}
\end{figure}

\subsection{Model Validation}
The model is separated into two parts, spoke adjustments which affect the variation of the three wheel parameters around a mean value, and adjustments which affect the mean tension.  The latter part of the model is found by determining the coefficient, $c$ between the average of the spoke adjustment vector and the average tension change of the wheel.  Fig(\ref{fig:c}) demonstrates the results of seven experiments. A linear fit to these data finds $c=-$473 N/rev. In practice, this constant could be derived from a single experiment where every spoke is adjusted by one revolution. 

 \begin{figure}[!t]
\centering
\includegraphics[width=3.25 in]{./figs/c}
\caption{The average tension change of a truing operation compared to the average of the spoke adjustment vector. A linear fit to the data  finds $c=-$473.}
\label{fig:c}
\end{figure}

To validate the model performance for spoke adjustment vectors that cause changes of the wheel state other than mean tension, a different experiment was performed.  In this case a random vector of spoke adjustments was applied to the (manually trued) test wheel and the resulting measured wheel parameters were compared to the model predictions. The truing algorithm was used to accurately make the spoke adjustments  Fig(\ref{fig:exp1}) shows the result of this experiment and Fig(\ref{fig:exp1_err}) shows the residual error of model after the adjustment. The rms model error of the lateral, radial and tension parameters are found to be 0.123mm, 0.049mm, and 33N, respectively. 

\begin{figure}[!t]
\centering
\includegraphics[width=3.25 in]{./figs/exp1}
\caption{The actual and predicted lateral, radial, and tension values for the random de-truing experiment.}
\label{fig:exp1}
\end{figure}

\begin{figure}[!t]
\centering
\includegraphics[width=3.25 in]{./figs/exp1_err}
\caption{The model error relative to the measurements for the random de-truing experiment.  The rms errors are found to be 0.123 mm (lateral), 0.049 mm (radial), and 33 N (tension).}
\label{fig:exp1_err}
\end{figure}

\subsection{Wheel Truing Validation}
To validate the complete model and truing algorithm the de-trued wheel from the previous experiment was trued to a target tension of 1000 N. Fig(\ref{fig:exp2}) shows the wheel state before and after the truing operation and Table(\ref{tbl:exp2}) summarizes the measurements. The maximum variations are 0.17 mm above the mean (lateral), 0.07 mm above the mean (radial), and 104 N below the mean (tension). 

Finally, to see whether the performance of the truing algorithm could improve the wheel from the truing experiment was trued again.  The results are shown in Table(\ref{tbl:exp3}). The performance is modestly improved for every parameter.

\begin{table}[!t]
\caption{Truing algorithm results}
\label{tbl:exp2}
\centering
\begin{tabular}{| l | c | c |}
    \hline
    Parameter & Inital ($\mu \pm \sigma$) & Final ($\mu \pm \sigma$)\\ \hline
    Lateral [mm] & $0.160\pm0.736$ &$-0.037\pm 0.107$ \\ \hline 
    Radial [mm] &$0.050\pm0.158$& $-0.046\pm0.047$ \\ \hline 
    Tension [N] &$556\pm211$& $1009\pm45$ \\ \hline
\end{tabular}
\end{table}

\begin{figure}[!t]
\centering
\includegraphics[width=3.25 in]{./figs/exp2}
\caption{The state of the wheel is shown before and after the truing operation. The results are summarized in the text.}
\label{fig:exp2}
\end{figure}

\begin{table}[!t]
\caption{Second iteration of truing}
\label{tbl:exp3}
\centering
\begin{tabular}{| l | c | c |}
    \hline
    Parameter & Inital ($\mu \pm \sigma$) & Final ($\mu \pm \sigma$)\\ \hline
    Lateral [mm] & $-0.037\pm0.107$ &$0.028\pm 0.073$ \\ \hline 
    Radial [mm] &$-0.046\pm0.047$& $-0.031\pm0.034$ \\ \hline 
    Tension [N] &$1009\pm45$& $989\pm39$ \\ \hline 
\end{tabular}
\end{table}


% needed in second column of first page if using \IEEEpubid
%\IEEEpubidadjcol




% An example of a floating figure using the graphicx package.
% Note that \label must occur AFTER (or within) \caption.
% For figures, \caption should occur after the \includegraphics.
% Note that IEEEtran v1.7 and later has special internal code that
% is designed to preserve the operation of \label within \caption
% even when the captionsoff option is in effect. However, because
% of issues like this, it may be the safest practice to put all your
% \label just after \caption rather than within \caption{}.
%
% Reminder: the "draftcls" or "draftclsnofoot", not "draft", class
% option should be used if it is desired that the figures are to be
% displayed while in draft mode.
%
%\begin{figure}[!t]
%\centering
%\includegraphics[width=2.5in]{myfigure}
% where an .eps filename suffix will be assumed under latex, 
% and a .pdf suffix will be assumed for pdflatex; or what has been declared
% via \DeclareGraphicsExtensions.
%\caption{Simulation results for the network.}
%\label{fig_sim}
%\end{figure}

% Note that the IEEE typically puts floats only at the top, even when this
% results in a large percentage of a column being occupied by floats.


% An example of a double column floating figure using two subfigures.
% (The subfig.sty package must be loaded for this to work.)
% The subfigure \label commands are set within each subfloat command,
% and the \label for the overall figure must come after \caption.
% \hfil is used as a separator to get equal spacing.
% Watch out that the combined width of all the subfigures on a 
% line do not exceed the text width or a line break will occur.
%
%\begin{figure*}[!t]
%\centering
%\subfloat[Case I]{\includegraphics[width=2.5in]{box}%
%\label{fig_first_case}}
%\hfil
%\subfloat[Case II]{\includegraphics[width=2.5in]{box}%
%\label{fig_second_case}}
%\caption{Simulation results for the network.}
%\label{fig_sim}
%\end{figure*}
%
% Note that often IEEE papers with subfigures do not employ subfigure
% captions (using the optional argument to \subfloat[]), but instead will
% reference/describe all of them (a), (b), etc., within the main caption.
% Be aware that for subfig.sty to generate the (a), (b), etc., subfigure
% labels, the optional argument to \subfloat must be present. If a
% subcaption is not desired, just leave its contents blank,
% e.g., \subfloat[].


% An example of a floating table. Note that, for IEEE style tables, the
% \caption command should come BEFORE the table and, given that table
% captions serve much like titles, are usually capitalized except for words
% such as a, an, and, as, at, but, by, for, in, nor, of, on, or, the, to
% and up, which are usually not capitalized unless they are the first or
% last word of the caption. Table text will default to \footnotesize as
% the IEEE normally uses this smaller font for tables.
% The \label must come after \caption as always.
%
%\begin{table}[!t]
%% increase table row spacing, adjust to taste
%\renewcommand{\arraystretch}{1.3}
% if using array.sty, it might be a good idea to tweak the value of
% \extrarowheight as needed to properly center the text within the cells
%\caption{An Example of a Table}
%\label{table_example}
%\centering
%% Some packages, such as MDW tools, offer better commands for making tables
%% than the plain LaTeX2e tabular which is used here.
%\begin{tabular}{|c||c|}
%\hline
%One & Two\\
%\hline
%Three & Four\\
%\hline
%\end{tabular}
%\end{table}


% Note that the IEEE does not put floats in the very first column
% - or typically anywhere on the first page for that matter. Also,
% in-text middle ("here") positioning is typically not used, but it
% is allowed and encouraged for Computer Society conferences (but
% not Computer Society journals). Most IEEE journals/conferences use
% top floats exclusively. 
% Note that, LaTeX2e, unlike IEEE journals/conferences, places
% footnotes above bottom floats. This can be corrected via the
% \fnbelowfloat command of the stfloats package.




\section{Conclusion}
These results successfully demonstrate that a linear wheel model can be developed empirically using standard system identification methodology.  This methodology consists of perturbing the wheel with known tension changes and measuring the resulting wheel state.  An optimal spoke tension adjustment vector can be found using weighted linear least squares analysis of the wheel errors.  This vector represents the best estimate for the adjustments  necessary to true the wheel. The weighting factors are determined by an analysis of their relative magnitudes as well as to meet a desired specification. In addition, the mean spoke tension can be separated from the spoke variation around the mean.  This allows accurate tension targeting even with relatively large errors in the tension influence matrix.

A truing algorithm that minimizes adjustment errors using a prediction of intermediate wheel states after adjustment of each spoke and lateral measurement feedback was demonstrated. This algorithm trues a wheel in a single iteration even to a significantly different tension. A second iteration of the truing algorithm can bring a small but significant improvement. The truing algorithm is also effective at minimizing spoke twist by detecting the hysteresis in the spoke nipple rotation and adjusting the nipple to the approximate midpoint of the hysteresis region once the lateral target is reached. 

The main limitation to the model is the inaccuracy and perhaps more importantly the coarse discretization of the tension measurements.  Because of this, the tension parameter is weighted relatively less than the radial and lateral parameters.  The resulting wheel states after a truing operation reflect this weighting and the tension errors away from the target tension approach 10\% in the worst case. The main limitation to the truing algorithm is the precision of the spoke tension adjustment.  Some spoke nipples didn't rotate smoothly on the test wheel, particularly at high tension.  Rather the nipple rotated in small discrete jumps as torque was applied.  Thus the error in the lateral target adjustment approached 0.1mm.  Using new components and appropriate lubrication would improve the precision of the adjustment and likely result in better performance.  Even despite these limitations, the test wheel was trued to tight specifications.

To improve upon the tension performance a higher resolution and more repeatable tension measurement is desired. One approach that has been suggested (ref Papadopoulos) is to estimate the frequency the first vibrational mode of the spoke after plucking the spoke as one would a guitar string.  The frequency is proportional to the square root of the tension thus the tension can be measured acoustically.  Another alternative is to measure the torque required to adjust the spoke. The tension can be determined from the torque. However, this approach is sensitive to lubrication as well as mechanical imperfections of the components and may not be as reliable. An alternative to measuring the spoke tension is to use a regularization technique instead of a full influence matrix.  Regularization places a cost on the amount of tension adjustment which is minimized along with the lateral and radial errors.  This was approach was tested in simulation and found to have higher error than using the tension influence matrix. 

As an aside, In this work an optical digitization of analog dial gauges was demonstrated to provide high precision measurements, at least as good as a pixel-level evaluation of images of the dial gauges.  This technique provides an effective alternative to digital gauges. 


% use section* for acknowledgment
\section*{Acknowledgment}

The authors would like to thank Matthew Ford for modeling discussions and Stuart Davis of Santa Cruz Bicycles for providing the initial inspiration for the study.


% Can use something like this to put references on a page
% by themselves when using endfloat and the captionsoff option.
\ifCLASSOPTIONcaptionsoff
  \newpage
\fi



% trigger a \newpage just before the given reference
% number - used to balance the columns on the last page
% adjust value as needed - may need to be readjusted if
% the document is modified later
%\IEEEtriggeratref{8}
% The "triggered" command can be changed if desired:
%\IEEEtriggercmd{\enlargethispage{-5in}}

% references section

% can use a bibliography generated by BibTeX as a .bbl file
% BibTeX documentation can be easily obtained at:
% http://mirror.ctan.org/biblio/bibtex/contrib/doc/
% The IEEEtran BibTeX style support page is at:
% http://www.michaelshell.org/tex/ieeetran/bibtex/
\bibliographystyle{IEEEtran}
% argument is your BibTeX string definitions and bibliography database(s)
\bibliography{WheelSysID}

% biography section
% 
% If you have an EPS/PDF photo (graphicx package needed) extra braces are
% needed around the contents of the optional argument to biography to prevent
% the LaTeX parser from getting confused when it sees the complicated
% \includegraphics command within an optional argument. (You could create
% your own custom macro containing the \includegraphics command to make things
% simpler here.)
%\begin{IEEEbiography}[{\includegraphics[width=1in,height=1.25in,clip,keepaspectratio]{mshell}}]{Michael Shell}
% or if you just want to reserve a space for a photo:

\begin{IEEEbiography}{Aaron Hunter}
Biography text here.
\end{IEEEbiography}

% if you will not have a photo at all:
\begin{IEEEbiographynophoto}{John Doe}
Biography text here.
\end{IEEEbiographynophoto}

% insert where needed to balance the two columns on the last page with
% biographies
%\newpage

\begin{IEEEbiographynophoto}{Jane Doe}
Biography text here.
\end{IEEEbiographynophoto}

% You can push biographies down or up by placing
% a \vfill before or after them. The appropriate
% use of \vfill depends on what kind of text is
% on the last page and whether or not the columns
% are being equalized.

%\vfill

% Can be used to pull up biographies so that the bottom of the last one
% is flush with the other column.
%\enlargethispage{-5in}



% that's all folks
\end{document}


